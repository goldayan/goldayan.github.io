<!DOCTYPE html><html><head><!--  --><meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Emacs Configuration Gold ayan</title>
<meta name="generator" content="Org Mode" />
<link href="https://fonts.cdnfonts.com/css/share-tech-mono" rel="stylesheet"><link rel="stylesheet" type="text/css" href="/assets/code.css"/><link rel="stylesheet" type="text/css" href="/assets/style.css"/>
</head><body><header><div class="container"><h1>Gold Ayan's Tinker Garage</h1></div><div class="header-content"><nav class="container"><ul class="topnav"><li><a href="/index.html">Home</a></li><li><a href="/projects.html">Projects</a></li><li><a href="/posts">Posts</a></li><li><a href="/til.html">TIL</a></li><li><a href="/blogrolls.html">Blogrolls</a></li><li><a href="/feed.xml">RSS</a></li></ul></nav></div></header><article class="container"><div class="blog-content"><p>
This is an ongoing evolution of my original Emacs configuration files, inspired by a bunch of resources I've found online.
</p>

<div id="outline-container-org4d07316" class="outline-2">
<h2 id="org4d07316">Startup Performance</h2>
<div class="outline-text-2" id="text-org4d07316">
<p>
Make startup faster by reducing the frequency of garbage collection and then use a hook to measure Emacs startup time.
</p>

<p>
Also, turn on <code>lexical-binding</code> for the init file!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">-*- lexical-binding: t; -*-
</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">The default is 800 kilobytes.  Measured in bytes.
</span>(<span class="org-keyword">setq</span> gc-cons-threshold (* 50 1000 1000))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Profile emacs startup
</span>(add-hook 'emacs-startup-hook
          (<span class="org-keyword">lambda</span> ()
            (message <span class="org-string">"*** Emacs loaded in %s with %d garbage collections."</span>
                     (format <span class="org-string">"%.2f seconds"</span>
                             (float-time
                              (time-subtract after-init-time before-init-time)))
                     gcs-done)))

</pre>
</div>
</div>
</div>

<div id="outline-container-org5157d3a" class="outline-2">
<h2 id="org5157d3a">Native Compilation</h2>
<div class="outline-text-2" id="text-org5157d3a">
<p>
I've started experimenting with the <code>native-comp</code> branch of Emacs for increased performance.  Here are some settings to tweak the behavior slightly:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Silence compiler warnings as they can be pretty disruptive
</span>(<span class="org-keyword">setq</span> native-comp-async-report-warnings-errors nil)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Set the right directory to store the native comp cache
</span>(add-to-list 'native-comp-eln-load-path (expand-file-name <span class="org-string">"eln-cache/"</span> user-emacs-directory))

</pre>
</div>
</div>
</div>

<div id="outline-container-org2d482db" class="outline-2">
<h2 id="org2d482db">System Settings</h2>
<div class="outline-text-2" id="text-org2d482db">
<p>
Some parts of the configuration require knowledge of whether Emacs is running on a Guix system or in Termux on Android.  Also load system-specific settings from <code>per-system-settings.el</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(load-file <span class="org-string">"~/.dotfiles/.emacs.d/lisp/dw-settings.el"</span>)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Load settings for the first time
</span>(dw/load-system-settings)

(<span class="org-keyword">require</span> '<span class="org-constant">subr-x</span>)
(<span class="org-keyword">setq</span> dw/is-termux
      (string-suffix-p <span class="org-string">"Android"</span> (string-trim (shell-command-to-string <span class="org-string">"uname -a"</span>))))

(<span class="org-keyword">setq</span> dw/is-guix-system (<span class="org-keyword">and</span> (eq system-type 'gnu/linux)
                             (<span class="org-keyword">require</span> '<span class="org-constant">f</span>)
                             (string-equal (f-read <span class="org-string">"/etc/issue"</span>)
                                           <span class="org-string">"\nThis is the GNU system.  Welcome.\n"</span>)))

</pre>
</div>
</div>
</div>

<div id="outline-container-org6d871f8" class="outline-2">
<h2 id="org6d871f8">Package Management</h2>
<div class="outline-text-2" id="text-org6d871f8">
<p>
Set up ELPA, MELPA, and Org package repositories and load <code>use-package</code> to manage package configuration.
</p>

<p>
<b>NOTE:</b> I'm keeping this section in but disabling tangling for now because I'm trying out <code>straight.el</code> as an alternative.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Initialize package sources
</span>(<span class="org-keyword">require</span> '<span class="org-constant">package</span>)

(<span class="org-keyword">setq</span> package-archives '((<span class="org-string">"melpa"</span> . <span class="org-string">"https://melpa.org/packages/"</span>)
                         (<span class="org-string">"melpa-stable"</span> . <span class="org-string">"https://stable.melpa.org/packages/"</span>)
                         (<span class="org-string">"org"</span> . <span class="org-string">"https://orgmode.org/elpa/"</span>)
                         (<span class="org-string">"elpa"</span> . <span class="org-string">"https://elpa.gnu.org/packages/"</span>)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Fix an issue accessing the ELPA archive in Termux
</span>(<span class="org-keyword">when</span> dw/is-termux
  (<span class="org-keyword">setq</span> gnutls-algorithm-priority <span class="org-string">"NORMAL:-VERS-TLS1.3"</span>))

(package-initialize)
<span class="org-comment-delimiter">;; </span><span class="org-comment">(unless package-archive-contents
</span><span class="org-comment-delimiter">;;   </span><span class="org-comment">(package-refresh-contents))
</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Initialize use-package on non-Linux platforms
</span>(<span class="org-keyword">unless</span> (<span class="org-keyword">or</span> (package-installed-p 'use-package)
            dw/is-guix-system)
   (package-install 'use-package))
(<span class="org-keyword">require</span> '<span class="org-constant">use-package</span>)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Uncomment this to get a reading on packages that get loaded at startup
</span><span class="org-comment-delimiter">;;</span><span class="org-comment">(setq use-package-verbose t)
</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">On non-Guix systems, "ensure" packages by default
</span>(<span class="org-keyword">setq</span> use-package-always-ensure (not dw/is-guix-system))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-use-package"</span>

</pre>
</div>
</div>

<div id="outline-container-org35c00ff" class="outline-3">
<h3 id="org35c00ff">straight.el</h3>
<div class="outline-text-3" id="text-org35c00ff">
<p>
Trying out <code>straight.el</code> for package management.  So far so good!
</p>

<p>
Sometimes it's good to clean up unused repositories if I've removed packages from my configuration.  Use <code>straight-remove-unused-repos</code> for this purpose.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Bootstrap straight.el
</span>(<span class="org-keyword">defvar</span> <span class="org-variable-name">bootstrap-version</span>)
(<span class="org-keyword">let</span> ((bootstrap-file
      (expand-file-name <span class="org-string">"straight/repos/straight.el/bootstrap.el"</span> user-emacs-directory))
      (bootstrap-version 5))
  (<span class="org-keyword">unless</span> (file-exists-p bootstrap-file)
    (<span class="org-keyword">with-current-buffer</span>
        (url-retrieve-synchronously
        <span class="org-string">"https://raw.githubusercontent.com/raxod502/straight.el/develop/install.el"</span>
        'silent 'inhibit-cookies)
      (goto-char (point-max))
      (eval-print-last-sexp)))
  (load bootstrap-file nil 'nomessage))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Always use straight to install on systems other than Linux
</span>(<span class="org-keyword">setq</span> straight-use-package-by-default (not (eq system-type 'gnu/linux)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Use straight.el for use-package expressions
</span>(straight-use-package 'use-package)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Clean up unused repos with `</span><span class="org-comment"><span class="org-constant">straight-remove-unused-repos</span></span><span class="org-comment">'
</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org24c98d4" class="outline-2">
<h2 id="org24c98d4">Keep .emacs.d Clean</h2>
<div class="outline-text-2" id="text-org24c98d4">
<p>
I don't want a bunch of transient files showing up as untracked in the Git repo so I move them all to another location.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Change the user-emacs-directory to keep unwanted things out of ~/.emacs.d
</span>(<span class="org-keyword">setq</span> user-emacs-directory (expand-file-name <span class="org-string">"~/.cache/emacs/"</span>)
      url-history-file (expand-file-name <span class="org-string">"url/history"</span> user-emacs-directory))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Use no-littering to automatically set common paths to the new user-emacs-directory
</span>(<span class="org-keyword">use-package</span> <span class="org-constant">no-littering</span>)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Keep customization settings in a temporary file (thanks Ambrevar!)
</span>(<span class="org-keyword">setq</span> custom-file
      (<span class="org-keyword">if</span> (boundp 'server-socket-dir)
          (expand-file-name <span class="org-string">"custom.el"</span> server-socket-dir)
        (expand-file-name (format <span class="org-string">"emacs-custom-%s.el"</span> (user-uid)) temporary-file-directory)))
(load custom-file t)

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-no-littering"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orga28ee27" class="outline-2">
<h2 id="orga28ee27">Update Load Path</h2>
<div class="outline-text-2" id="text-orga28ee27">
<p>
I've got a folder of custom Emacs Lisp libraries which must be added to the load path.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Add my library path to load-path
</span>(<span class="org-keyword">push</span> <span class="org-string">"~/.dotfiles/.emacs.d/lisp"</span> load-path)

</pre>
</div>
</div>
</div>

<div id="outline-container-orgc1a2704" class="outline-2">
<h2 id="orgc1a2704">Default Coding System</h2>
<div class="outline-text-2" id="text-orgc1a2704">
<p>
Avoid constant errors on Windows about the coding system by setting the default to UTF-8.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(set-default-coding-systems 'utf-8)

</pre>
</div>
</div>
</div>

<div id="outline-container-org7a35035" class="outline-2">
<h2 id="org7a35035">Server Mode</h2>
<div class="outline-text-2" id="text-org7a35035">
<p>
Start the Emacs server from this instance so that all <code>emacsclient</code> calls are routed here.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(server-start)

</pre>
</div>
</div>
</div>

<div id="outline-container-orge9a30bf" class="outline-2">
<h2 id="orge9a30bf">Desktop Environment</h2>
<div class="outline-text-2" id="text-orge9a30bf">
<p>
Load up the desktop environment if on a machine that supports it and the <code>--use-exwm</code> argument was passed to Emacs on startup.  Desktop environment and window management code can be found in Desktop.org.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">setq</span> dw/exwm-enabled (<span class="org-keyword">and</span> (not dw/is-termux)
                           (eq window-system 'x)
                           (seq-contains command-line-args <span class="org-string">"--use-exwm"</span>)))

(<span class="org-keyword">when</span> dw/exwm-enabled
  (<span class="org-keyword">require</span> '<span class="org-constant">dw-desktop</span>))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<p>
Despite the code being in Desktop.org, include the emacs packages for the desktop environment in this file so that they can be included in the Emacs profile.
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-exwm"</span>
<span class="org-string">"emacs-desktop-environment"</span>
<span class="org-string">"emacs-stumpwm-mode"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org6aa2feb" class="outline-2">
<h2 id="org6aa2feb">Keyboard Bindings</h2>
<div class="outline-text-2" id="text-org6aa2feb">
</div>
<div id="outline-container-org32e5f0d" class="outline-3">
<h3 id="org32e5f0d">ESC Cancels All</h3>
<div class="outline-text-3" id="text-org32e5f0d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(global-set-key (kbd <span class="org-string">"&lt;escape&gt;"</span>) 'keyboard-escape-quit)

</pre>
</div>
</div>
</div>

<div id="outline-container-org14fdc62" class="outline-3">
<h3 id="org14fdc62">Rebind C-u</h3>
<div class="outline-text-3" id="text-org14fdc62">
<p>
Since I let <code>evil-mode</code> take over <code>C-u</code> for buffer scrolling, I need to re-bind the <code>universal-argument</code> command to another key sequence.  I'm choosing <code>C-M-u</code> for this purpose.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(global-set-key (kbd <span class="org-string">"C-M-u"</span>) 'universal-argument)

</pre>
</div>
</div>
</div>

<div id="outline-container-org7bfdaec" class="outline-3">
<h3 id="org7bfdaec">Let's Be Evil</h3>
<div class="outline-text-3" id="text-org7bfdaec">
<p>
Some tips can be found here:
</p>

<ul class="org-ul">
<li><a href="https://github.com/noctuid/evil-guide">https://github.com/noctuid/evil-guide</a></li>
<li><a href="https://nathantypanski.com/blog/2014-08-03-a-vim-like-emacs-config.html">https://nathantypanski.com/blog/2014-08-03-a-vim-like-emacs-config.html</a></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">defun</span> <span class="org-function-name">dw/evil-hook</span> ()
  (<span class="org-keyword">dolist</span> (mode '(custom-mode
                  eshell-mode
                  git-rebase-mode
                  erc-mode
                  circe-server-mode
                  circe-chat-mode
                  circe-query-mode
                  sauron-mode
                  term-mode))
  (add-to-list 'evil-emacs-state-modes mode)))

(<span class="org-keyword">defun</span> <span class="org-function-name">dw/dont-arrow-me-bro</span> ()
  (<span class="org-keyword">interactive</span>)
  (message <span class="org-string">"Arrow keys are bad, you know?"</span>))

(<span class="org-keyword">use-package</span> <span class="org-constant">undo-tree</span>
  <span class="org-builtin">:init</span>
  (global-undo-tree-mode 1))

(<span class="org-keyword">use-package</span> <span class="org-constant">evil</span>
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> evil-want-integration t)
  (<span class="org-keyword">setq</span> evil-want-keybinding nil)
  (<span class="org-keyword">setq</span> evil-want-C-u-scroll t)
  (<span class="org-keyword">setq</span> evil-want-C-i-jump nil)
  (<span class="org-keyword">setq</span> evil-respect-visual-line-mode t)
  (<span class="org-keyword">setq</span> evil-undo-system 'undo-tree)
  <span class="org-builtin">:config</span>
  (add-hook 'evil-mode-hook 'dw/evil-hook)
  (evil-mode 1)
  (define-key evil-insert-state-map (kbd <span class="org-string">"C-g"</span>) 'evil-normal-state)
  (define-key evil-insert-state-map (kbd <span class="org-string">"C-h"</span>) 'evil-delete-backward-char-and-join)

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Use visual line motions even outside of visual-line-mode buffers
</span>  (evil-global-set-key 'motion <span class="org-string">"j"</span> 'evil-next-visual-line)
  (evil-global-set-key 'motion <span class="org-string">"k"</span> 'evil-previous-visual-line)

  (<span class="org-keyword">unless</span> dw/is-termux
    <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable arrow keys in normal and visual modes
</span>    (define-key evil-normal-state-map (kbd <span class="org-string">"&lt;left&gt;"</span>) 'dw/dont-arrow-me-bro)
    (define-key evil-normal-state-map (kbd <span class="org-string">"&lt;right&gt;"</span>) 'dw/dont-arrow-me-bro)
    (define-key evil-normal-state-map (kbd <span class="org-string">"&lt;down&gt;"</span>) 'dw/dont-arrow-me-bro)
    (define-key evil-normal-state-map (kbd <span class="org-string">"&lt;up&gt;"</span>) 'dw/dont-arrow-me-bro)
    (evil-global-set-key 'motion (kbd <span class="org-string">"&lt;left&gt;"</span>) 'dw/dont-arrow-me-bro)
    (evil-global-set-key 'motion (kbd <span class="org-string">"&lt;right&gt;"</span>) 'dw/dont-arrow-me-bro)
    (evil-global-set-key 'motion (kbd <span class="org-string">"&lt;down&gt;"</span>) 'dw/dont-arrow-me-bro)
    (evil-global-set-key 'motion (kbd <span class="org-string">"&lt;up&gt;"</span>) 'dw/dont-arrow-me-bro))

  (evil-set-initial-state 'messages-buffer-mode 'normal)
  (evil-set-initial-state 'dashboard-mode 'normal))

(<span class="org-keyword">use-package</span> <span class="org-constant">evil-collection</span>
  <span class="org-builtin">:after</span> evil
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> evil-collection-company-use-tng nil)  <span class="org-comment-delimiter">;; </span><span class="org-comment">Is this a bug in evil-collection?
</span>  <span class="org-builtin">:custom</span>
  (evil-collection-outline-bind-tab-p nil)
  <span class="org-builtin">:config</span>
  (delete 'lispy evil-collection-mode-list)
  (delete 'org-present evil-collection-mode-list)
  (evil-collection-init))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-evil"</span>
<span class="org-string">"emacs-evil-collection"</span>
<span class="org-string">"emacs-undo-tree"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org61572fc" class="outline-3">
<h3 id="org61572fc">Keybinding Panel (which-key)</h3>
<div class="outline-text-3" id="text-org61572fc">
<p>
<a href="https://github.com/justbur/emacs-which-key">which-key</a> is great for getting an overview of what keybindings are available
based on the prefix keys you entered.  Learned about this one from Spacemacs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">which-key</span>
  <span class="org-builtin">:init</span> (which-key-mode)
  <span class="org-builtin">:diminish</span> which-key-mode
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> which-key-idle-delay 0.3))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-which-key"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orged14ae8" class="outline-3">
<h3 id="orged14ae8">Simplify Leader Bindings (general.el)</h3>
<div class="outline-text-3" id="text-orged14ae8">
<p>
<a href="https://github.com/noctuid/general.el">general.el</a> is a fantastic library for defining prefixed keybindings, especially
in conjunction with Evil modes.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">general</span>
  <span class="org-builtin">:config</span>
  (general-evil-setup t)

  (general-create-definer dw/leader-key-def
    <span class="org-builtin">:keymaps</span> '(normal insert visual emacs)
    <span class="org-builtin">:prefix</span> <span class="org-string">"SPC"</span>
    <span class="org-builtin">:global-prefix</span> <span class="org-string">"C-SPC"</span>)

  (general-create-definer dw/ctrl-c-keys
    <span class="org-builtin">:prefix</span> <span class="org-string">"C-c"</span>))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-general"</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgdc1eb24" class="outline-2">
<h2 id="orgdc1eb24">General Configuration</h2>
<div class="outline-text-2" id="text-orgdc1eb24">
</div>
<div id="outline-container-org83a25c5" class="outline-3">
<h3 id="org83a25c5">User Interface</h3>
<div class="outline-text-3" id="text-org83a25c5">
<p>
Clean up Emacs' user interface, make it more minimal.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Thanks, but no thanks
</span>(<span class="org-keyword">setq</span> inhibit-startup-message t)

(<span class="org-keyword">unless</span> dw/is-termux
  (scroll-bar-mode -1)        <span class="org-comment-delimiter">; </span><span class="org-comment">Disable visible scrollbar
</span>  (tool-bar-mode -1)          <span class="org-comment-delimiter">; </span><span class="org-comment">Disable the toolbar
</span>  (tooltip-mode -1)           <span class="org-comment-delimiter">; </span><span class="org-comment">Disable tooltips
</span>  (set-fringe-mode 10))       <span class="org-comment-delimiter">; </span><span class="org-comment">Give some breathing room
</span>
(menu-bar-mode -1)            <span class="org-comment-delimiter">; </span><span class="org-comment">Disable the menu bar
</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">Set up the visible bell
</span>(<span class="org-keyword">setq</span> visible-bell t)

</pre>
</div>

<p>
Improve scrolling.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">unless</span> dw/is-termux
  (<span class="org-keyword">setq</span> mouse-wheel-scroll-amount '(1 ((shift) . 1))) <span class="org-comment-delimiter">;; </span><span class="org-comment">one line at a time
</span>  (<span class="org-keyword">setq</span> mouse-wheel-progressive-speed nil) <span class="org-comment-delimiter">;; </span><span class="org-comment">don't accelerate scrolling
</span>  (<span class="org-keyword">setq</span> mouse-wheel-follow-mouse 't) <span class="org-comment-delimiter">;; </span><span class="org-comment">scroll window under mouse
</span>  (<span class="org-keyword">setq</span> scroll-step 1) <span class="org-comment-delimiter">;; </span><span class="org-comment">keyboard scroll one line at a time
</span>  (<span class="org-keyword">setq</span> use-dialog-box nil)) <span class="org-comment-delimiter">;; </span><span class="org-comment">Disable dialog boxes since they weren't working in Mac OSX
</span>
</pre>
</div>

<p>
Set frame transparency and maximize windows by default.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">unless</span> dw/is-termux
  (set-frame-parameter (selected-frame) 'alpha '(90 . 90))
  (add-to-list 'default-frame-alist '(alpha . (90 . 90)))
  (set-frame-parameter (selected-frame) 'fullscreen 'maximized)
  (add-to-list 'default-frame-alist '(fullscreen . maximized)))

</pre>
</div>

<p>
Enable line numbers and customize their format.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(column-number-mode)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Enable line numbers for some modes
</span>(<span class="org-keyword">dolist</span> (mode '(text-mode-hook
                prog-mode-hook
                conf-mode-hook))
  (add-hook mode (<span class="org-keyword">lambda</span> () (display-line-numbers-mode 1))))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Override some modes which derive from the above
</span>(<span class="org-keyword">dolist</span> (mode '(org-mode-hook))
  (add-hook mode (<span class="org-keyword">lambda</span> () (display-line-numbers-mode 0))))

</pre>
</div>

<p>
Don't warn for large files (shows up when launching videos)
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">setq</span> large-file-warning-threshold nil)

</pre>
</div>

<p>
Don't warn for following symlinked files
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">setq</span> vc-follow-symlinks t)

</pre>
</div>

<p>
Don't warn when advice is added for functions
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">setq</span> ad-redefinition-action 'accept)

</pre>
</div>
</div>
</div>

<div id="outline-container-org4da65a5" class="outline-3">
<h3 id="org4da65a5">Theme</h3>
<div class="outline-text-3" id="text-org4da65a5">
<p>
These days I bounce around between themes included with <a href="https://github.com/hlissner/emacs-doom-themes">DOOM Themes</a> since they're well-designed and integrate with a lot of Emacs packages.
</p>

<p>
A nice gallery of Emacs themes can be found at <a href="https://emacsthemes.com/">https://emacsthemes.com/</a>.
</p>

<p>
Alternate themes:
</p>

<ul class="org-ul">
<li><code>doom-snazzy</code></li>
<li><code>doom-vibrant</code></li>
</ul>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">spacegray-theme</span> <span class="org-builtin">:defer</span> t)
(<span class="org-keyword">use-package</span> <span class="org-constant">doom-themes</span> <span class="org-builtin">:defer</span> t)
(<span class="org-keyword">unless</span> dw/is-termux
  (load-theme 'doom-palenight t)
  (doom-themes-visual-bell-config))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-doom-themes"</span>
<span class="org-string">"emacs-spacegray-theme"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org34cc5fa" class="outline-3">
<h3 id="org34cc5fa">Font</h3>
<div class="outline-text-3" id="text-org34cc5fa">
</div>
<div id="outline-container-orgbcd72ea" class="outline-4">
<h4 id="orgbcd72ea">Set the font</h4>
<div class="outline-text-4" id="text-orgbcd72ea">
<p>
Different platforms need different default font sizes, and <a href="https://mozilla.github.io/Fira/">Fira Mono</a> is currently my favorite face.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Set the font face based on platform
</span>(<span class="org-keyword">pcase</span> system-type
  ((<span class="org-keyword">or</span> 'gnu/linux 'windows-nt 'cygwin)
   (set-face-attribute 'default nil
                       <span class="org-builtin">:font</span> <span class="org-string">"JetBrains Mono"</span>
                       <span class="org-builtin">:weight</span> 'light
                       <span class="org-builtin">:height</span> (dw/system-settings-get 'emacs/default-face-size)))
  ('darwin (set-face-attribute 'default nil <span class="org-builtin">:font</span> <span class="org-string">"Fira Mono"</span> <span class="org-builtin">:height</span> 170)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Set the fixed pitch face
</span>(set-face-attribute 'fixed-pitch nil
                    <span class="org-builtin">:font</span> <span class="org-string">"JetBrains Mono"</span>
                    <span class="org-builtin">:weight</span> 'light
                    <span class="org-builtin">:height</span> (dw/system-settings-get 'emacs/fixed-face-size))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Set the variable pitch face
</span>(set-face-attribute 'variable-pitch nil
                    <span class="org-comment-delimiter">;; </span><span class="org-comment">:font "Cantarell"
</span>                    <span class="org-builtin">:font</span> <span class="org-string">"Iosevka Aile"</span>
                    <span class="org-builtin">:height</span> (dw/system-settings-get 'emacs/variable-face-size)
                    <span class="org-builtin">:weight</span> 'light)

</pre>
</div>
</div>
</div>

<div id="outline-container-org5f4babf" class="outline-4">
<h4 id="org5f4babf">Enable proper Unicode glyph support</h4>
<div class="outline-text-4" id="text-org5f4babf">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">defun</span> <span class="org-function-name">dw/replace-unicode-font-mapping</span> (block-name old-font new-font)
  (<span class="org-keyword">let*</span> ((block-idx (cl-position-if
                         (<span class="org-keyword">lambda</span> (i) (string-equal (car i) block-name))
                         unicode-fonts-block-font-mapping))
         (block-fonts (cadr (nth block-idx unicode-fonts-block-font-mapping)))
         (updated-block (cl-substitute new-font old-font block-fonts <span class="org-builtin">:test</span> 'string-equal)))
    (<span class="org-keyword">setf</span> (cdr (nth block-idx unicode-fonts-block-font-mapping))
          `(,updated-block))))

(<span class="org-keyword">use-package</span> <span class="org-constant">unicode-fonts</span>
  <span class="org-builtin">:disabled</span>
  <span class="org-builtin">:if</span> (not dw/is-termux)
  <span class="org-builtin">:custom</span>
  (unicode-fonts-skip-font-groups '(low-quality-glyphs))
  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Fix the font mappings to use the right emoji font
</span>  (mapcar
    (<span class="org-keyword">lambda</span> (block-name)
      (dw/replace-unicode-font-mapping block-name <span class="org-string">"Apple Color Emoji"</span> <span class="org-string">"Noto Color Emoji"</span>))
    '(<span class="org-string">"Dingbats"</span>
      <span class="org-string">"Emoticons"</span>
      <span class="org-string">"Miscellaneous Symbols and Pictographs"</span>
      <span class="org-string">"Transport and Map Symbols"</span>))
  (unicode-fonts-setup))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-comment-delimiter">;; </span><span class="org-comment">"emacs-unicode-fonts"
</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org25e69ea" class="outline-4">
<h4 id="org25e69ea">Emojis in buffers</h4>
<div class="outline-text-4" id="text-org25e69ea">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">emojify</span>
  <span class="org-builtin">:hook</span> (erc-mode . emojify-mode)
  <span class="org-builtin">:commands</span> emojify-mode)

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-emojify"</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org73b18fa" class="outline-3">
<h3 id="org73b18fa">Mode Line</h3>
<div class="outline-text-3" id="text-org73b18fa">
</div>
<div id="outline-container-orgd9fba14" class="outline-4">
<h4 id="orgd9fba14">Basic Customization</h4>
<div class="outline-text-4" id="text-orgd9fba14">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">setq</span> display-time-format <span class="org-string">"%l:%M %p %b %y"</span>
      display-time-default-load-average nil)

</pre>
</div>
</div>
</div>

<div id="outline-container-org5945ded" class="outline-4">
<h4 id="org5945ded">Enable Mode Diminishing</h4>
<div class="outline-text-4" id="text-org5945ded">
<p>
The <a href="https://github.com/myrjola/diminish.el">diminish</a> package hides pesky minor modes from the modelines.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">diminish</span>)

</pre>
</div>
</div>
</div>

<div id="outline-container-orge874ee6" class="outline-4">
<h4 id="orge874ee6">Smart Mode Line</h4>
<div class="outline-text-4" id="text-orge874ee6">
<p>
Prettify the modeline with <a href="https://github.com/Malabarba/smart-mode-line/">smart-mode-line</a>.  Really need to re-evaluate the
ordering of <code>mode-line-format</code>.  Also not sure if <code>rm-excluded-modes</code> is needed
anymore if I set up <code>diminish</code> correctly.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">smart-mode-line</span>
  <span class="org-builtin">:disabled</span>
  <span class="org-builtin">:if</span> dw/is-termux
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> sml/no-confirm-load-theme t)
  (sml/setup)
  (sml/apply-theme 'respectful)  <span class="org-comment-delimiter">; </span><span class="org-comment">Respect the theme colors
</span>  (<span class="org-keyword">setq</span> sml/mode-width 'right
      sml/name-width 60)

  (<span class="org-keyword">setq-default</span> mode-line-format
  `(<span class="org-string">"%e"</span>
      ,(<span class="org-keyword">when</span> dw/exwm-enabled
          '(<span class="org-builtin">:eval</span> (format <span class="org-string">"[%d] "</span> exwm-workspace-current-index)))
      mode-line-front-space
      evil-mode-line-tag
      mode-line-mule-info
      mode-line-client
      mode-line-modified
      mode-line-remote
      mode-line-frame-identification
      mode-line-buffer-identification
      sml/pos-id-separator
      (vc-mode vc-mode)
      <span class="org-string">" "</span>
      <span class="org-comment-delimiter">;</span><span class="org-comment">mode-line-position
</span>      sml/pre-modes-separator
      mode-line-modes
      <span class="org-string">" "</span>
      mode-line-misc-info))

  (<span class="org-keyword">setq</span> rm-excluded-modes
    (mapconcat
      'identity
      <span class="org-comment-delimiter">; </span><span class="org-comment">These names must start with a space!
</span>      '(<span class="org-string">" GitGutter"</span> <span class="org-string">" MRev"</span> <span class="org-string">" company"</span>
      <span class="org-string">" Helm"</span> <span class="org-string">" Undo-Tree"</span> <span class="org-string">" Projectile.*"</span> <span class="org-string">" Z"</span> <span class="org-string">" Ind"</span>
      <span class="org-string">" Org-Agenda.*"</span> <span class="org-string">" ElDoc"</span> <span class="org-string">" SP/s"</span> <span class="org-string">" cider.*"</span>)
      <span class="org-string">"</span><span class="org-string"><span class="org-regexp-grouping-backslash">\\</span></span><span class="org-string"><span class="org-regexp-grouping-construct">|</span></span><span class="org-string">"</span>)))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-smart-mode-line"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orga58e03a" class="outline-4">
<h4 id="orga58e03a">Doom Modeline</h4>
<div class="outline-text-4" id="text-orga58e03a">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">You must run (all-the-icons-install-fonts) one time after
</span><span class="org-comment-delimiter">;; </span><span class="org-comment">installing this package!
</span>
(<span class="org-keyword">use-package</span> <span class="org-constant">minions</span>
  <span class="org-builtin">:hook</span> (doom-modeline-mode . minions-mode))

(<span class="org-keyword">use-package</span> <span class="org-constant">doom-modeline</span>
  <span class="org-builtin">:after</span> eshell     <span class="org-comment-delimiter">;; </span><span class="org-comment">Make sure it gets hooked after eshell
</span>  <span class="org-builtin">:hook</span> (after-init . doom-modeline-init)
  <span class="org-builtin">:custom-face</span>
  (mode-line ((t (<span class="org-builtin">:height</span> 0.85))))
  (mode-line-inactive ((t (<span class="org-builtin">:height</span> 0.85))))
  <span class="org-builtin">:custom</span>
  (doom-modeline-height 15)
  (doom-modeline-bar-width 6)
  (doom-modeline-lsp t)
  (doom-modeline-github nil)
  (doom-modeline-mu4e nil)
  (doom-modeline-irc t)
  (doom-modeline-minor-modes t)
  (doom-modeline-persp-name nil)
  (doom-modeline-buffer-file-name-style 'truncate-except-project)
  (doom-modeline-major-mode-icon nil))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-doom-modeline"</span>
<span class="org-string">"emacs-all-the-icons"</span>
<span class="org-string">"emacs-minions"</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org95da10a" class="outline-3">
<h3 id="org95da10a">Workspaces</h3>
<div class="outline-text-3" id="text-org95da10a">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">perspective</span>
  <span class="org-builtin">:demand</span> t
  <span class="org-builtin">:bind</span> ((<span class="org-string">"C-M-k"</span> . persp-switch)
         (<span class="org-string">"C-M-n"</span> . persp-next)
         (<span class="org-string">"C-x k"</span> . persp-kill-buffer*))
  <span class="org-builtin">:custom</span>
  (persp-initial-frame-name <span class="org-string">"Main"</span>)
  <span class="org-builtin">:config</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">Running `</span><span class="org-comment"><span class="org-constant">persp-mode</span></span><span class="org-comment">' multiple times resets the perspective list...
</span>  (<span class="org-keyword">unless</span> (equal persp-mode t)
    (persp-mode)))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-perspective"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orgbad539c" class="outline-3">
<h3 id="orgbad539c">Notifications</h3>
<div class="outline-text-3" id="text-orgbad539c">
<p>
<a href="https://github.com/jwiegley/alert">alert</a> is a great library for showing notifications from other packages in a variety of ways.  For now I just use it to surface desktop notifications from package code.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">alert</span>
  <span class="org-builtin">:commands</span> alert
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> alert-default-style 'notifications))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-alert"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org6eec5f4" class="outline-3">
<h3 id="org6eec5f4">Auto-Saving Changed Files</h3>
<div class="outline-text-3" id="text-org6eec5f4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">super-save</span>
  <span class="org-builtin">:defer</span> 1
  <span class="org-builtin">:diminish</span> super-save-mode
  <span class="org-builtin">:config</span>
  (super-save-mode +1)
  (<span class="org-keyword">setq</span> super-save-auto-save-when-idle t))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-super-save"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org0072199" class="outline-3">
<h3 id="org0072199">Auto-Reverting Changed Files</h3>
<div class="outline-text-3" id="text-org0072199">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Revert Dired and other buffers
</span>(<span class="org-keyword">setq</span> global-auto-revert-non-file-buffers t)

<span class="org-comment-delimiter">;; </span><span class="org-comment">Revert buffers when the underlying file has changed
</span>(global-auto-revert-mode 1)

</pre>
</div>
</div>
</div>

<div id="outline-container-org5f0d676" class="outline-3">
<h3 id="org5f0d676">UI Toggles</h3>
<div class="outline-text-3" id="text-org5f0d676">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(dw/leader-key-def
  <span class="org-string">"t"</span>  '(<span class="org-builtin">:ignore</span> t <span class="org-builtin">:which-key</span> <span class="org-string">"toggles"</span>)
  <span class="org-string">"tw"</span> 'whitespace-mode
  <span class="org-string">"tt"</span> '(counsel-load-theme <span class="org-builtin">:which-key</span> <span class="org-string">"choose theme"</span>))

</pre>
</div>
</div>
</div>

<div id="outline-container-org3bdebfa" class="outline-3">
<h3 id="org3bdebfa">Highlight Matching Braces</h3>
<div class="outline-text-3" id="text-org3bdebfa">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">paren</span>
  <span class="org-builtin">:config</span>
  (set-face-attribute 'show-paren-match-expression nil <span class="org-builtin">:background</span> <span class="org-string">"#363e4a"</span>)
  (show-paren-mode 1))

</pre>
</div>
</div>
</div>

<div id="outline-container-org7fc7a4f" class="outline-3">
<h3 id="org7fc7a4f">Displaying World Time</h3>
<div class="outline-text-3" id="text-org7fc7a4f">
<p>
<code>display-time-world</code> command provides a nice display of the time at a specified
list of timezones.  Nice for working in a team with remote members.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">setq</span> display-time-world-list
  '((<span class="org-string">"Etc/UTC"</span> <span class="org-string">"UTC"</span>)
    (<span class="org-string">"America/Los_Angeles"</span> <span class="org-string">"Seattle"</span>)
    (<span class="org-string">"America/New_York"</span> <span class="org-string">"New York"</span>)
    (<span class="org-string">"Europe/Athens"</span> <span class="org-string">"Athens"</span>)
    (<span class="org-string">"Pacific/Auckland"</span> <span class="org-string">"Auckland"</span>)
    (<span class="org-string">"Asia/Shanghai"</span> <span class="org-string">"Shanghai"</span>)
    (<span class="org-string">"Asia/Kolkata"</span> <span class="org-string">"Hyderabad"</span>)))
(<span class="org-keyword">setq</span> display-time-world-time-format <span class="org-string">"%a, %d %b %I:%M %p %Z"</span>)

</pre>
</div>
</div>
</div>

<div id="outline-container-orge075a99" class="outline-3">
<h3 id="orge075a99">Pinentry</h3>
<div class="outline-text-3" id="text-orge075a99">
<p>
Emacs can be prompted for the PIN of GPG private keys, we just need to set
<code>epa-pinentry-mode</code> to accomplish that:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">unless</span> (<span class="org-keyword">or</span> dw/is-termux
            (eq system-type 'windows-nt))
  (<span class="org-keyword">setq</span> epa-pinentry-mode 'loopback)
  (pinentry-start))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-pinentry"</span>
<span class="org-string">"pinentry-emacs"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org7a35e6d" class="outline-3">
<h3 id="org7a35e6d">TRAMP</h3>
<div class="outline-text-3" id="text-org7a35e6d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
<span class="org-comment-delimiter">;; </span><span class="org-comment">Set default connection mode to SSH
</span>(<span class="org-keyword">setq</span> tramp-default-method <span class="org-string">"ssh"</span>)

</pre>
</div>
</div>
</div>

<div id="outline-container-orge264679" class="outline-3">
<h3 id="orge264679">Emacs as External Editor</h3>
<div class="outline-text-3" id="text-orge264679">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">defun</span> <span class="org-function-name">dw/show-server-edit-buffer</span> (buffer)
  <span class="org-comment-delimiter">;; </span><span class="org-comment">TODO: Set a transient keymap to close with 'C-c C-c'
</span>  (split-window-vertically -15)
  (other-window 1)
  (set-buffer buffer))

<span class="org-comment-delimiter">;; </span><span class="org-comment">(setq server-window #'dw/show-server-edit-buffer)
</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org7cdb972" class="outline-2">
<h2 id="org7cdb972">Editing Configuration</h2>
<div class="outline-text-2" id="text-org7cdb972">
</div>
<div id="outline-container-org1f89356" class="outline-3">
<h3 id="org1f89356">Tab Widths</h3>
<div class="outline-text-3" id="text-org1f89356">
<p>
Default to an indentation size of 2 spaces since it's the norm for pretty much every language I use.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">setq-default</span> tab-width 2)
(<span class="org-keyword">setq-default</span> evil-shift-width tab-width)

</pre>
</div>
</div>
</div>

<div id="outline-container-orgab2aa35" class="outline-3">
<h3 id="orgab2aa35">Use spaces instead of tabs for indentation</h3>
<div class="outline-text-3" id="text-orgab2aa35">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">setq-default</span> indent-tabs-mode nil)

</pre>
</div>
</div>
</div>

<div id="outline-container-orga483274" class="outline-3">
<h3 id="orga483274">Commenting Lines</h3>
<div class="outline-text-3" id="text-orga483274">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">evil-nerd-commenter</span>
  <span class="org-builtin">:bind</span> (<span class="org-string">"M-/"</span> . evilnc-comment-or-uncomment-lines))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-evil-nerd-commenter"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org6ea5d06" class="outline-3">
<h3 id="org6ea5d06">Automatically clean whitespace</h3>
<div class="outline-text-3" id="text-org6ea5d06">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">ws-butler</span>
  <span class="org-builtin">:hook</span> ((text-mode . ws-butler-mode)
         (prog-mode . ws-butler-mode)))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-ws-butler"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-orga4a0f89" class="outline-3">
<h3 id="orga4a0f89">Use Parinfer for Lispy languages</h3>
<div class="outline-text-3" id="text-orga4a0f89">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">parinfer</span>
  <span class="org-builtin">:disabled</span>
  <span class="org-builtin">:hook</span> ((clojure-mode . parinfer-mode)
         (emacs-lisp-mode . parinfer-mode)
         (common-lisp-mode . parinfer-mode)
         (scheme-mode . parinfer-mode)
         (lisp-mode . parinfer-mode))
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> parinfer-extensions
      '(defaults       <span class="org-comment-delimiter">; </span><span class="org-comment">should be included.
</span>        pretty-parens  <span class="org-comment-delimiter">; </span><span class="org-comment">different paren styles for different modes.
</span>        evil           <span class="org-comment-delimiter">; </span><span class="org-comment">If you use Evil.
</span>        smart-tab      <span class="org-comment-delimiter">; </span><span class="org-comment">C-b &amp; C-f jump positions and smart shift with tab &amp; S-tab.
</span>        smart-yank)))  <span class="org-comment-delimiter">; </span><span class="org-comment">Yank behavior depend on mode.
</span>
(dw/leader-key-def
  <span class="org-string">"tp"</span> 'parinfer-toggle-mode)

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-parinfer-mode"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org8347824" class="outline-3">
<h3 id="org8347824">Origami.el for Folding</h3>
<div class="outline-text-3" id="text-org8347824">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">origami</span>
  <span class="org-builtin">:hook</span> (yaml-mode . origami-mode))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-origami-el"</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf679f2d" class="outline-2">
<h2 id="orgf679f2d">Configuration Files</h2>
<div class="outline-text-2" id="text-orgf679f2d">
</div>
<div id="outline-container-orge359072" class="outline-3">
<h3 id="orge359072">Configuration file management with dotcrafter.el</h3>
<div class="outline-text-3" id="text-orge359072">
<p>
I've been working on a package called <a href="https://github.com/daviwil/dotcrafter.el">dotcrafter.el</a> for complete management of your dotfiles folder with special emphasis on configurations written with Org Mode.
</p>

<p>
Check out my <a href="https://systemcrafters.cc/learning-emacs-lisp/">Learning Emacs Lisp</a> series to see this package be written from scratch!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">dotcrafter</span>
  <span class="org-builtin">:straight</span> '(dotcrafter <span class="org-builtin">:host</span> github
                          <span class="org-builtin">:repo</span> <span class="org-string">"daviwil/dotcrafter.el"</span>
                          <span class="org-builtin">:branch</span> <span class="org-string">"main"</span>)
  <span class="org-builtin">:custom</span>
  (dotcrafter-org-files '(<span class="org-string">"Emacs.org"</span>
                          <span class="org-string">"Desktop.org"</span>
                          <span class="org-string">"Stump.org"</span>
                          <span class="org-string">"Systems.org"</span>
                          <span class="org-string">"Mail.org"</span>
                          <span class="org-string">"Workflow.org"</span>))
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">require</span> '<span class="org-constant">dotcrafter</span>) <span class="org-comment-delimiter">; </span><span class="org-comment">Not sure why I have to do this...
</span>  <span class="org-builtin">:config</span>
  (dotcrafter-mode))

</pre>
</div>
</div>
</div>

<div id="outline-container-orgf0dcf79" class="outline-3">
<h3 id="orgf0dcf79">Helpers</h3>
<div class="outline-text-3" id="text-orgf0dcf79">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">defun</span> <span class="org-function-name">dw/org-file-jump-to-heading</span> (org-file heading-title)
  (<span class="org-keyword">interactive</span>)
  (find-file (expand-file-name org-file))
  (goto-char (point-min))
  (search-forward (concat <span class="org-string">"* "</span> heading-title))
  (org-overview)
  (org-reveal)
  (org-show-subtree)
  (forward-line))

(<span class="org-keyword">defun</span> <span class="org-function-name">dw/org-file-show-headings</span> (org-file)
  (<span class="org-keyword">interactive</span>)
  (find-file (expand-file-name org-file))
  (counsel-org-goto)
  (org-overview)
  (org-reveal)
  (org-show-subtree)
  (forward-line))

</pre>
</div>
</div>
</div>

<div id="outline-container-org4d9adec" class="outline-3">
<h3 id="org4d9adec">Bindings</h3>
<div class="outline-text-3" id="text-org4d9adec">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(dw/leader-key-def
  <span class="org-string">"fn"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (counsel-find-file <span class="org-string">"~/Notes/"</span>)) <span class="org-builtin">:which-key</span> <span class="org-string">"notes"</span>)
  <span class="org-string">"fd"</span>  '(<span class="org-builtin">:ignore</span> t <span class="org-builtin">:which-key</span> <span class="org-string">"dotfiles"</span>)
  <span class="org-string">"fdd"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (find-file <span class="org-string">"~/.dotfiles/Desktop.org"</span>)) <span class="org-builtin">:which-key</span> <span class="org-string">"desktop"</span>)
  <span class="org-string">"fde"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (find-file (expand-file-name <span class="org-string">"~/.dotfiles/Emacs.org"</span>))) <span class="org-builtin">:which-key</span> <span class="org-string">"edit config"</span>)
  <span class="org-string">"fdE"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (dw/org-file-show-headings <span class="org-string">"~/.dotfiles/Emacs.org"</span>)) <span class="org-builtin">:which-key</span> <span class="org-string">"edit config"</span>)
  <span class="org-string">"fdm"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (find-file <span class="org-string">"~/.dotfiles/Mail.org"</span>)) <span class="org-builtin">:which-key</span> <span class="org-string">"mail"</span>)
  <span class="org-string">"fdM"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (counsel-find-file <span class="org-string">"~/.dotfiles/.config/guix/manifests/"</span>)) <span class="org-builtin">:which-key</span> <span class="org-string">"manifests"</span>)
  <span class="org-string">"fds"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (dw/org-file-jump-to-heading <span class="org-string">"~/.dotfiles/Systems.org"</span> <span class="org-string">"Base Configuration"</span>)) <span class="org-builtin">:which-key</span> <span class="org-string">"base system"</span>)
  <span class="org-string">"fdS"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (dw/org-file-jump-to-heading <span class="org-string">"~/.dotfiles/Systems.org"</span> system-name)) <span class="org-builtin">:which-key</span> <span class="org-string">"this system"</span>)
  <span class="org-string">"fdp"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (dw/org-file-jump-to-heading <span class="org-string">"~/.dotfiles/Desktop.org"</span> <span class="org-string">"Panel via Polybar"</span>)) <span class="org-builtin">:which-key</span> <span class="org-string">"polybar"</span>)
  <span class="org-string">"fdw"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (find-file (expand-file-name <span class="org-string">"~/.dotfiles/Workflow.org"</span>))) <span class="org-builtin">:which-key</span> <span class="org-string">"workflow"</span>)
  <span class="org-string">"fdv"</span> '((<span class="org-keyword">lambda</span> () (<span class="org-keyword">interactive</span>) (find-file <span class="org-string">"~/.dotfiles/.config/vimb/config"</span>)) <span class="org-builtin">:which-key</span> <span class="org-string">"vimb"</span>))

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org1d28e67" class="outline-2">
<h2 id="org1d28e67">Stateful Keymaps with Hydra</h2>
<div class="outline-text-2" id="text-org1d28e67">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">hydra</span>
  <span class="org-builtin">:defer</span> 1)

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-hydra"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org5858598" class="outline-2">
<h2 id="org5858598">Completion System</h2>
<div class="outline-text-2" id="text-org5858598">
<p>
Trying this as an alternative to Ivy and Counsel.
</p>
</div>

<div id="outline-container-org705d758" class="outline-3">
<h3 id="org705d758">Preserve Minibuffer History with savehist-mode</h3>
<div class="outline-text-3" id="text-org705d758">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">savehist</span>
  <span class="org-builtin">:config</span>
  (<span class="org-keyword">setq</span> history-length 25)
  (savehist-mode 1))

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Individual history elements can be configured separately
</span>  <span class="org-comment-delimiter">;;</span><span class="org-comment">(put 'minibuffer-history 'history-length 25)
</span>  <span class="org-comment-delimiter">;;</span><span class="org-comment">(put 'evil-ex-history 'history-length 50)
</span>  <span class="org-comment-delimiter">;;</span><span class="org-comment">(put 'kill-ring 'history-length 25))
</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org145d26e" class="outline-3">
<h3 id="org145d26e">Completions with Vertico</h3>
<div class="outline-text-3" id="text-org145d26e">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">defun</span> <span class="org-function-name">dw/minibuffer-backward-kill</span> (arg)
  <span class="org-doc">"When minibuffer is completing a file name delete up to parent
folder, otherwise delete a word"</span>
  (<span class="org-keyword">interactive</span> <span class="org-string">"p"</span>)
  (<span class="org-keyword">if</span> minibuffer-completing-file-name
      <span class="org-comment-delimiter">;; </span><span class="org-comment">Borrowed from https://github.com/raxod502/selectrum/issues/498#issuecomment-803283608
</span>      (<span class="org-keyword">if</span> (string-match-p <span class="org-string">"/."</span> (minibuffer-contents))
          (zap-up-to-char (- arg) ?/)
        (delete-minibuffer-contents))
      (delete-word (- arg))))

(<span class="org-keyword">use-package</span> <span class="org-constant">vertico</span>
  <span class="org-comment-delimiter">;; </span><span class="org-comment">:straight '(vertico :host github
</span>  <span class="org-comment-delimiter">;;                     </span><span class="org-comment">:repo "minad/vertico"
</span>  <span class="org-comment-delimiter">;;                     </span><span class="org-comment">:branch "main")
</span>  <span class="org-builtin">:bind</span> (<span class="org-builtin">:map</span> vertico-map
         (<span class="org-string">"C-j"</span> . vertico-next)
         (<span class="org-string">"C-k"</span> . vertico-previous)
         (<span class="org-string">"C-f"</span> . vertico-exit)
         <span class="org-builtin">:map</span> minibuffer-local-map
         (<span class="org-string">"M-h"</span> . dw/minibuffer-backward-kill))
  <span class="org-builtin">:custom</span>
  (vertico-cycle t)
  <span class="org-builtin">:custom-face</span>
  (vertico-current ((t (<span class="org-builtin">:background</span> <span class="org-string">"#3a3f5a"</span>))))
  <span class="org-builtin">:init</span>
  (vertico-mode))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-vertico"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org854e450" class="outline-3">
<h3 id="org854e450">Completions in Regions with Corfu</h3>
<div class="outline-text-3" id="text-org854e450">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">corfu</span>
  <span class="org-builtin">:straight</span> '(corfu <span class="org-builtin">:host</span> github
                    <span class="org-builtin">:repo</span> <span class="org-string">"minad/corfu"</span>)
  <span class="org-builtin">:bind</span> (<span class="org-builtin">:map</span> corfu-map
         (<span class="org-string">"C-j"</span> . corfu-next)
         (<span class="org-string">"C-k"</span> . corfu-previous)
         (<span class="org-string">"C-f"</span> . corfu-insert))
  <span class="org-builtin">:custom</span>
  (corfu-cycle t)
  <span class="org-builtin">:config</span>
  (corfu-global-mode))

</pre>
</div>
</div>
</div>

<div id="outline-container-org013e7da" class="outline-3">
<h3 id="org013e7da">Improved Candidate Filtering with Orderless</h3>
<div class="outline-text-3" id="text-org013e7da">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">orderless</span>
  <span class="org-builtin">:init</span>
  (<span class="org-keyword">setq</span> completion-styles '(orderless)
        completion-category-defaults nil
        completion-category-overrides '((file (styles . (partial-completion))))))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-orderless"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org73ca686" class="outline-3">
<h3 id="org73ca686">Consult Commands</h3>
<div class="outline-text-3" id="text-org73ca686">
<p>
Consult provides a lot of useful completion commands similar to Ivy's Counsel.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">defun</span> <span class="org-function-name">dw/get-project-root</span> ()
  (<span class="org-keyword">when</span> (fboundp 'projectile-project-root)
    (projectile-project-root)))

(<span class="org-keyword">use-package</span> <span class="org-constant">consult</span>
  <span class="org-builtin">:demand</span> t
  <span class="org-builtin">:bind</span> ((<span class="org-string">"C-s"</span> . consult-line)
         (<span class="org-string">"C-M-l"</span> . consult-imenu)
         (<span class="org-string">"C-M-j"</span> . persp-switch-to-buffer*)
         <span class="org-builtin">:map</span> minibuffer-local-map
         (<span class="org-string">"C-r"</span> . consult-history))
  <span class="org-builtin">:custom</span>
  (consult-project-root-function #'dw/get-project-root)
  (completion-in-region-function #'consult-completion-in-region))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-consult"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org88cafd8" class="outline-3">
<h3 id="org88cafd8">Switching Directories with consult-dir</h3>
<div class="outline-text-3" id="text-org88cafd8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">consult-dir</span>
  <span class="org-builtin">:straight</span> t
  <span class="org-builtin">:bind</span> ((<span class="org-string">"C-x C-d"</span> . consult-dir)
         <span class="org-builtin">:map</span> vertico-map
         (<span class="org-string">"C-x C-d"</span> . consult-dir)
         (<span class="org-string">"C-x C-j"</span> . consult-dir-jump-file))
  <span class="org-builtin">:custom</span>
  (consult-dir-project-list-function nil))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Thanks Karthik!
</span>(<span class="org-keyword">with-eval-after-load</span> 'eshell-mode
  (<span class="org-keyword">defun</span> <span class="org-function-name">eshell/z</span> (<span class="org-type">&amp;optional</span> regexp)
    <span class="org-doc">"Navigate to a previously visited directory in eshell."</span>
    (<span class="org-keyword">let</span> ((eshell-dirs (delete-dups (mapcar 'abbreviate-file-name
                                            (ring-elements eshell-last-dir-ring)))))
      (<span class="org-keyword">cond</span>
       ((<span class="org-keyword">and</span> (not regexp) (<span class="org-keyword">featurep</span> '<span class="org-constant">consult-dir</span>))
        (<span class="org-keyword">let*</span> ((consult-dir--source-eshell `(<span class="org-builtin">:name</span> <span class="org-string">"Eshell"</span>
                                                   <span class="org-builtin">:narrow</span> ?e
                                                   <span class="org-builtin">:category</span> file
                                                   <span class="org-builtin">:face</span> consult-file
                                                   <span class="org-builtin">:items</span> ,eshell-dirs))
               (consult-dir-sources (cons consult-dir--source-eshell consult-dir-sources)))
          (eshell/cd (substring-no-properties (consult-dir--pick <span class="org-string">"Switch directory: "</span>)))))
       (t (eshell/cd (<span class="org-keyword">if</span> regexp (eshell-find-previous-directory regexp)
                       (completing-read <span class="org-string">"cd: "</span> eshell-dirs))))))))

</pre>
</div>
</div>
</div>

<div id="outline-container-orgdd6ab4e" class="outline-3">
<h3 id="orgdd6ab4e">Completion Annotations with Marginalia</h3>
<div class="outline-text-3" id="text-orgdd6ab4e">
<p>
Marginalia provides helpful annotations for various types of minibuffer completions.  You can think of it as a replacement of <code>ivy-rich</code>.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">marginalia</span>
  <span class="org-builtin">:after</span> vertico
  <span class="org-builtin">:custom</span>
  (marginalia-annotators '(marginalia-annotators-heavy marginalia-annotators-light nil))
  <span class="org-builtin">:init</span>
  (marginalia-mode))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-marginalia"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org9676a3d" class="outline-3">
<h3 id="org9676a3d">Completion Actions with Embark</h3>
<div class="outline-text-3" id="text-org9676a3d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">embark</span>
  <span class="org-builtin">:bind</span> ((<span class="org-string">"C-S-a"</span> . embark-act)
         <span class="org-builtin">:map</span> minibuffer-local-map
         (<span class="org-string">"C-d"</span> . embark-act))
  <span class="org-builtin">:config</span>

  <span class="org-comment-delimiter">;; </span><span class="org-comment">Show Embark actions via which-key
</span>  (<span class="org-keyword">setq</span> embark-action-indicator
        (<span class="org-keyword">lambda</span> (map)
          (which-key--show-keymap <span class="org-string">"Embark"</span> map nil nil 'no-paging)
          #'which-key--hide-popup-ignore-command)
        embark-become-indicator embark-action-indicator))

<span class="org-comment-delimiter">;; </span><span class="org-comment">(use-package embark-consult
</span><span class="org-comment-delimiter">;;   </span><span class="org-comment">:straight '(embark-consult :host github
</span><span class="org-comment-delimiter">;;                              </span><span class="org-comment">:repo "oantolin/embark"
</span><span class="org-comment-delimiter">;;                              </span><span class="org-comment">:files ("embark-consult.el"))
</span><span class="org-comment-delimiter">;;   </span><span class="org-comment">:after (embark consult)
</span><span class="org-comment-delimiter">;;   </span><span class="org-comment">:demand t
</span><span class="org-comment-delimiter">;;   </span><span class="org-comment">:hook
</span><span class="org-comment-delimiter">;;   </span><span class="org-comment">(embark-collect-mode . embark-consult-preview-minor-mode))
</span>
</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-embark"</span>

</pre>
</div>
</div>
</div>

<div id="outline-container-org62f7393" class="outline-3">
<h3 id="org62f7393">Launching apps</h3>
<div class="outline-text-3" id="text-org62f7393">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">app-launcher</span>)

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-app-launcher"</span>

</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org16f20c3" class="outline-2">
<h2 id="org16f20c3">Jumping with Avy</h2>
<div class="outline-text-2" id="text-org16f20c3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">
(<span class="org-keyword">use-package</span> <span class="org-constant">avy</span>
  <span class="org-builtin">:commands</span> (avy-goto-char avy-goto-word-0 avy-goto-line))

(dw/leader-key-def
  <span class="org-string">"j"</span>   '(<span class="org-builtin">:ignore</span> t <span class="org-builtin">:which-key</span> <span class="org-string">"jump"</span>)
  <span class="org-string">"jj"</span>  '(avy-goto-char <span class="org-builtin">:which-key</span> <span class="org-string">"jump to char"</span>)
  <span class="org-string">"jw"</span>  '(avy-goto-word-0 <span class="org-builtin">:which-key</span> <span class="org-string">"jump to word"</span>)
  <span class="org-string">"jl"</span>  '(avy-goto-line <span class="org-builtin">:which-key</span> <span class="org-string">"jump to line"</span>))

</pre>
</div>

<p>
<b>Guix Packages</b>
</p>

<div class="org-src-container">
<pre class="src src-scheme">
<span class="org-string">"emacs-avy"</span>

</pre>
</div>
</div>
</div>
</div></article><footer>This site is made with  using Emacs.</footer></body></html>
